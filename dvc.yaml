# Brick DVC stages
# See https://dvc.org/doc/user-guide/project-structure/dvcyaml-files#pipelines-files-dvcyaml

# The complete process can be executed using:
# dvc repro
# If you want to force redoing the process use 
# dvc repro -f
# Individual stage can be executed using: 
# dvc repro <stage>

stages:
  list:
    cmd: stages/01_list.sh
    deps:
      - stages/01_list.sh
    outs:
      - list
  install: 
    cmd: stages/02_install.sh
    deps:
      - stages/02_install.sh
      - list
  extract: 
    cmd: uv run stages/03_extract.py
    deps:
      - stages/03_extract.py
      - list
    outs:
      - tmp/other
  extract-hdt:
    cmd: stages/04_extract_hdt.sh
    deps:
      - stages/04_extract_hdt.sh
      - list
    outs:
      - tmp/hdt
  # merge-metadata:
  #   cmd: cp -r tmp/hdt/* cache/ && cp -r tmp/other/* cache/ && rm -rf tmp
  #   deps:
  #     - tmp/hdt
  #     - tmp/other
  #   outs:
  #     - cache/